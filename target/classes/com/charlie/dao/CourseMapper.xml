<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.charlie.dao.CourseDao">

    <resultMap id="course" type="com.charlie.entity.Course">
        <id property="cno" column="cno"/>
        <result property="cname" column="cname"/>
        <result property="term" column="term"/>
        <result property="cscore" column="cscore"/>
        <result property="locked" column="locked"/>
        <result property="classroom" column="classroom"/>
        <result property="weekend" column="weekend"/>
        <result property="capacity" column="capacity"/>
        <result property="csname" column="csname"/>
        <association property="times" javaType="com.charlie.entity.Times">
            <id property="time_id" column="time_id"/>
        </association>
        <association property="teacher" javaType="com.charlie.entity.Teacher">
            <id property="tno" column="tno"/>
            <result property="tname" column="tname"/>
            <result property="title" column="title"/>
            <association property="department" javaType="com.charlie.entity.Department">
                <id property="de_id" column="de_id"/>
                <result property="departName" column="departName"/>
            </association>
        </association>
    </resultMap>

    <select id="getStudentSelectedAllCourseMessage" resultMap="course">
        select c.*, tname ,title, d.* from course c ,teacher t, department d where c.tno = t.tno and t.de_id  = d.de_id and c.cno = #{cno}
    </select>

    <select id="getAllCourseMessage" resultMap="course">
        select c.*, tname ,title, d.* from course c ,teacher t, department d where c.tno = t.tno and t.de_id  = d.de_id and (c.term = 0 or c.term = #{term}) and (c.locked = 0 or c.locked = #{de_id})  order by cname
    </select>

</mapper>